<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galactic AI Assistant</title>
    
    <!-- CUSTOM FAVICON -->
    <link rel="icon" type="image/x-icon" href="image/icon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="image/icon.ico">
    
    <!-- PWA ICONS FOR MOBILE -->
    <link rel="apple-touch-icon" href="image/icon.ico">
    <meta name="theme-color" content="#06FFA5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Galactic AI">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Exo 2', sans-serif;
            background: #000000;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        /* ANIMATED GIF BACKGROUND SYSTEM */
        .gif-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }

        .gif-background.active {
            opacity: 1;
        }

        .gif-background img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.7) contrast(1.1) saturate(1.2);
        }

        /* OVERLAY FOR BETTER CONTRAST */
        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at center, transparent 0%, rgba(0, 0, 0, 0.3) 70%),
                linear-gradient(45deg, rgba(6, 255, 165, 0.05), rgba(138, 45, 226, 0.05), rgba(255, 0, 110, 0.05));
            pointer-events: none;
            z-index: 1;
        }

        /* PREMIUM PARTICLE OVERLAY */
        .particle-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .floating-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(6, 255, 165, 0.6);
            border-radius: 50%;
            animation: particleFloat 8s linear infinite;
            box-shadow: 
                0 0 6px currentColor,
                0 0 12px currentColor;
        }

        .floating-particle:nth-child(2n) {
            background: rgba(138, 45, 226, 0.6);
            animation-delay: -2s;
        }

        .floating-particle:nth-child(3n) {
            background: rgba(255, 0, 110, 0.6);
            animation-delay: -4s;
        }

        .floating-particle:nth-child(4n) {
            background: rgba(255, 184, 0, 0.6);
            animation-delay: -6s;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) translateX(0px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-20vh) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* BACKGROUND SELECTOR */
        .bg-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            flex-direction: column;
        }

        .bg-option {
            width: 60px;
            height: 40px;
            border: 2px solid rgba(6, 255, 165, 0.5);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3);
        }

        .bg-option:hover {
            border-color: #06FFA5;
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(6, 255, 165, 0.5);
        }

        .bg-option.active {
            border-color: #06FFA5;
            box-shadow: 0 0 25px rgba(6, 255, 165, 0.8);
        }

        .bg-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8);
        }

        .bg-option::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(6, 255, 165, 0.2);
            opacity: 0;
            transition: opacity 0.3s;
        }

        /* SETTINGS DIALOG */
        .settings-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: dialogFadeIn 0.3s ease-out;
        }

        .settings-dialog.show {
            display: flex;
        }

        @keyframes dialogFadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .dialog-content {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 2px solid transparent;
            border-radius: 20px;
            background-clip: padding-box;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: 
                0 0 50px rgba(6, 255, 165, 0.3),
                0 0 100px rgba(142, 45, 226, 0.2),
                inset 0 0 50px rgba(255, 255, 255, 0.05);
            animation: dialogSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .dialog-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, #06FFA5, #8E2DE2, #FF006E, #FFB800, #06FFA5);
            border-radius: 20px;
            padding: 2px;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: xor;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            z-index: -1;
            animation: borderRotate 6s linear infinite;
        }

        @keyframes dialogSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .dialog-header {
            color: #06FFA5;
            font-family: 'Orbitron', monospace;
            font-size: 20px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .dialog-header::before {
            content: '⚙️';
            display: block;
            font-size: 30px;
            margin-bottom: 10px;
            animation: rotate 4s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            color: #06FFA5;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            display: block;
            margin-bottom: 8px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .dialog-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 255, 165, 0.3);
            border-radius: 12px;
            color: #06FFA5;
            font-family: 'Exo 2', sans-serif;
            font-size: 14px;
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dialog-input:focus {
            outline: none;
            border-color: #06FFA5;
            background: rgba(6, 255, 165, 0.1);
            box-shadow: 
                0 0 30px rgba(6, 255, 165, 0.3),
                inset 0 0 20px rgba(6, 255, 165, 0.1);
            transform: translateY(-2px);
        }

        .dialog-input::placeholder {
            color: rgba(6, 255, 165, 0.5);
        }

        .dialog-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .dialog-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            font-family: 'Orbitron', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }

        .dialog-btn.primary {
            background: linear-gradient(135deg, #06FFA5, #8E2DE2);
            color: white;
            border: 2px solid rgba(6, 255, 165, 0.5);
            box-shadow: 0 8px 25px rgba(6, 255, 165, 0.3);
        }

        .dialog-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(6, 255, 165, 0.5);
        }

        .dialog-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .dialog-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .close-dialog {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            padding: 5px;
            border-radius: 50%;
        }

        /* AUDIO TOGGLE BUTTON */
        .audio-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 255, 165, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .audio-toggle:hover {
            border-color: #06FFA5;
            background: rgba(6, 255, 165, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(6, 255, 165, 0.3);
        }

        .audio-toggle.active {
            border-color: #06FFA5;
            background: rgba(6, 255, 165, 0.15);
            box-shadow: 0 0 25px rgba(6, 255, 165, 0.4);
        }

        .audio-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .audio-icon {
            font-size: 20px;
            transition: all 0.3s;
        }

        .audio-toggle.active .audio-icon {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .audio-text {
            color: #06FFA5;
            font-family: 'Exo 2', sans-serif;
            font-weight: 500;
        }

        .audio-status {
            color: rgba(6, 255, 165, 0.7);
            font-size: 12px;
            font-family: 'Orbitron', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* VOLUME CONTROL */
        .volume-control {
            margin-top: 15px;
            display: none;
        }

        .volume-control.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .volume-slider {
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: rgba(6, 255, 165, 0.2);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: linear-gradient(135deg, #06FFA5, #8E2DE2);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(6, 255, 165, 0.5);
            transition: all 0.3s;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            transform: scale(1.3);
            box-shadow: 0 0 15px rgba(6, 255, 165, 0.8);
        }

        .volume-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: linear-gradient(135deg, #06FFA5, #8E2DE2);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 10px rgba(6, 255, 165, 0.5);
        }

        .info-text {
            color: rgba(6, 255, 165, 0.7);
            font-size: 11px;
            text-align: center;
            margin-top: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid rgba(6, 255, 165, 0.2);
        }

        /* SETTINGS BUTTON */
        .settings-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, rgba(6, 255, 165, 0.2), rgba(138, 45, 226, 0.2));
            border: 2px solid rgba(6, 255, 165, 0.5);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            color: #06FFA5;
            backdrop-filter: blur(15px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px rgba(6, 255, 165, 0.3);
        }

        .settings-btn:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 12px 35px rgba(6, 255, 165, 0.5);
            background: linear-gradient(135deg, rgba(6, 255, 165, 0.3), rgba(138, 45, 226, 0.3));
        }

        .settings-btn::before {
            content: '⚙️';
            animation: rotate 8s linear infinite;
        }

        /* MAIN CONTAINER */
        .chat-container {
            width: min(500px, 90vw);
            height: min(750px, 90vh);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(25px);
            border: 2px solid transparent;
            border-radius: 30px;
            background-clip: padding-box;
            position: relative;
            box-shadow: 
                0 0 50px rgba(6, 255, 165, 0.3),
                0 0 100px rgba(142, 45, 226, 0.2),
                inset 0 0 50px rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 10;
            animation: containerPulse 4s ease-in-out infinite;
        }

        .chat-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, #06FFA5, #8E2DE2, #FF006E, #FFB800, #06FFA5);
            border-radius: 30px;
            padding: 2px;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: xor;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            z-index: -1;
            animation: borderRotate 6s linear infinite;
        }

        @keyframes borderRotate {
            0% {
                background: linear-gradient(45deg, #06FFA5, #8E2DE2, #FF006E, #FFB800, #06FFA5);
            }
            25% {
                background: linear-gradient(135deg, #8E2DE2, #FF006E, #FFB800, #06FFA5, #8E2DE2);
            }
            50% {
                background: linear-gradient(225deg, #FF006E, #FFB800, #06FFA5, #8E2DE2, #FF006E);
            }
            75% {
                background: linear-gradient(315deg, #FFB800, #06FFA5, #8E2DE2, #FF006E, #FFB800);
            }
            100% {
                background: linear-gradient(45deg, #06FFA5, #8E2DE2, #FF006E, #FFB800, #06FFA5);
            }
        }

        @keyframes containerPulse {
            0%, 100% { 
                box-shadow: 
                    0 0 50px rgba(6, 255, 165, 0.3),
                    0 0 100px rgba(142, 45, 226, 0.2),
                    inset 0 0 50px rgba(255, 255, 255, 0.05);
            }
            50% { 
                box-shadow: 
                    0 0 80px rgba(6, 255, 165, 0.5),
                    0 0 150px rgba(142, 45, 226, 0.4),
                    inset 0 0 80px rgba(255, 255, 255, 0.1);
            }
        }

        /* HEADER */
        .chat-header {
            background: linear-gradient(135deg, 
                rgba(6, 255, 165, 0.2), 
                rgba(142, 45, 226, 0.2), 
                rgba(255, 0, 110, 0.2));
            color: #06FFA5;
            padding: 30px;
            text-align: center;
            font-family: 'Orbitron', monospace;
            font-size: 24px;
            font-weight: 900;
            letter-spacing: 3px;
            text-transform: uppercase;
            border-bottom: 1px solid rgba(6, 255, 165, 0.3);
            position: relative;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            font-size: 40px;
            display: block;
            margin-bottom: 10px;
            animation: rotate3D 6s linear infinite;
        }

        .chat-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(6, 255, 165, 0.4), 
                transparent);
            animation: scanning 3s linear infinite;
        }

        @keyframes rotate3D {
            0% { transform: rotateY(0deg) rotateX(0deg); }
            25% { transform: rotateY(90deg) rotateX(0deg); }
            50% { transform: rotateY(180deg) rotateX(90deg); }
            75% { transform: rotateY(270deg) rotateX(180deg); }
            100% { transform: rotateY(360deg) rotateX(360deg); }
        }

        @keyframes scanning {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* STATUS INDICATORS */
        .status-panel {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
        }

        .status-orb {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: orbPulse 2s infinite;
        }

        .orb-1 {
            background: #06FFA5;
            box-shadow: 0 0 20px #06FFA5;
            animation-delay: 0s;
        }

        .orb-2 {
            background: #8E2DE2;
            box-shadow: 0 0 20px #8E2DE2;
            animation-delay: 0.5s;
        }

        .orb-3 {
            background: #FF006E;
            box-shadow: 0 0 20px #FF006E;
            animation-delay: 1s;
        }

        @keyframes orbPulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }

        /* API SETUP */
        .api-setup {
            padding: 25px;
            background: linear-gradient(135deg, 
                rgba(6, 255, 165, 0.1), 
                rgba(142, 45, 226, 0.1));
            border-bottom: 1px solid rgba(6, 255, 165, 0.2);
            backdrop-filter: blur(15px);
        }

        .api-setup strong {
            color: #06FFA5;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            display: block;
            margin-bottom: 15px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .api-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 255, 165, 0.3);
            border-radius: 15px;
            color: #06FFA5;
            font-family: 'Exo 2', sans-serif;
            font-size: 14px;
            backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .api-input:focus {
            outline: none;
            border-color: #06FFA5;
            background: rgba(6, 255, 165, 0.1);
            box-shadow: 
                0 0 30px rgba(6, 255, 165, 0.3),
                inset 0 0 20px rgba(6, 255, 165, 0.1);
            transform: translateY(-2px);
        }

        .api-input::placeholder {
            color: rgba(6, 255, 165, 0.5);
        }

        /* MESSAGES */
        .chat-messages {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: rgba(6, 255, 165, 0.1);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #06FFA5, #8E2DE2);
            border-radius: 4px;
        }

        .message {
            max-width: 85%;
            padding: 20px 25px;
            border-radius: 25px;
            word-wrap: break-word;
            animation: messageBeam 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            backdrop-filter: blur(15px);
            font-size: 14px;
            line-height: 1.6;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes messageBeam {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.8) rotateX(90deg);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1) rotateX(0deg);
            }
        }

        .user-message {
            background: linear-gradient(135deg, 
                rgba(6, 255, 165, 0.3), 
                rgba(142, 45, 226, 0.3));
            color: #ffffff;
            align-self: flex-end;
            border-bottom-right-radius: 8px;
            box-shadow: 
                0 10px 30px rgba(6, 255, 165, 0.3),
                0 0 50px rgba(142, 45, 226, 0.2);
            border: 1px solid rgba(6, 255, 165, 0.4);
        }

        .ai-message {
            background: linear-gradient(135deg, 
                rgba(255, 0, 110, 0.2), 
                rgba(255, 184, 0, 0.2));
            color: #ffffff;
            align-self: flex-start;
            border-bottom-left-radius: 8px;
            box-shadow: 
                0 10px 30px rgba(255, 0, 110, 0.3),
                0 0 50px rgba(255, 184, 0, 0.2);
            border: 1px solid rgba(255, 0, 110, 0.4);
        }

        /* INPUT AREA */
        .chat-input-container {
            padding: 30px;
            background: linear-gradient(135deg, 
                rgba(6, 255, 165, 0.1), 
                rgba(142, 45, 226, 0.1));
            display: flex;
            gap: 15px;
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(6, 255, 165, 0.2);
        }

        .chat-input {
            flex: 1;
            padding: 18px 25px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 255, 165, 0.3);
            border-radius: 30px;
            outline: none;
            font-size: 14px;
            color: #ffffff;
            font-family: 'Exo 2', sans-serif;
            backdrop-filter: blur(15px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .chat-input:focus {
            border-color: #06FFA5;
            background: rgba(6, 255, 165, 0.1);
            box-shadow: 
                0 0 40px rgba(6, 255, 165, 0.4),
                inset 0 0 20px rgba(6, 255, 165, 0.1);
            transform: translateY(-3px);
        }

        .chat-input::placeholder {
            color: rgba(6, 255, 165, 0.6);
        }

        .send-btn {
            padding: 18px 30px;
            background: linear-gradient(135deg, #06FFA5, #8E2DE2, #FF006E);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 700;
            font-size: 14px;
            font-family: 'Orbitron', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 10px 30px rgba(6, 255, 165, 0.4),
                0 0 50px rgba(142, 45, 226, 0.3);
            border: 2px solid rgba(6, 255, 165, 0.5);
            position: relative;
            overflow: hidden;
        }

        .send-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent);
            transition: left 0.6s;
        }

        .send-btn:hover::before {
            left: 100%;
        }

        .send-btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 
                0 15px 40px rgba(6, 255, 165, 0.6),
                0 0 80px rgba(142, 45, 226, 0.5);
        }

        .send-btn:active {
            transform: translateY(-2px) scale(1.02);
        }

        .send-btn:disabled {
            background: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.5;
        }

        /* TYPING INDICATOR */
        .typing-indicator {
            align-self: flex-start;
            padding: 20px 25px;
            background: linear-gradient(135deg, 
                rgba(255, 0, 110, 0.2), 
                rgba(255, 184, 0, 0.2));
            border-radius: 25px;
            border-bottom-left-radius: 8px;
            display: flex;
            gap: 8px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 0, 110, 0.4);
            box-shadow: 0 10px 30px rgba(255, 0, 110, 0.3);
        }

        .typing-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #06FFA5;
            animation: cosmicTyping 1.6s infinite ease-in-out;
            box-shadow: 0 0 10px #06FFA5;
        }

        .typing-dot:nth-child(1) { 
            animation-delay: -0.32s; 
            background: #06FFA5;
        }
        .typing-dot:nth-child(2) { 
            animation-delay: -0.16s; 
            background: #8E2DE2;
            box-shadow: 0 0 10px #8E2DE2;
        }
        .typing-dot:nth-child(3) { 
            background: #FF006E;
            box-shadow: 0 0 10px #FF006E;
        }

        @keyframes cosmicTyping {
            0%, 80%, 100% { 
                transform: scale(0.8) translateY(0);
                opacity: 0.6;
            }
            40% { 
                transform: scale(1.3) translateY(-10px);
                opacity: 1;
            }
        }

        /* COOKIE INFO */
        .api-setup div {
            color: rgba(6, 255, 165, 0.8);
            font-size: 11px;
            margin-top: 12px;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            border: 1px solid rgba(6, 255, 165, 0.2);
            backdrop-filter: blur(10px);
        }

        /* MOBILE OPTIMIZATIONS */
        @media (max-width: 768px) {
            body {
                padding: 0;
                margin: 0;
            }

            /* HIDE BACKGROUND SELECTOR ON MOBILE */
            .bg-selector {
                display: none !important;
            }

            /* MOBILE DEFAULT BACKGROUND */
            .gif-background:not(.active) {
                display: none;
            }

            .chat-container {
                width: 100vw;
                height: 100vh;
                height: 100dvh; /* Dynamic viewport height for mobile keyboards */
                border-radius: 0;
                max-width: none;
                max-height: none;
                min-height: 100vh;
                min-height: 100dvh;
                position: fixed;
                top: 0;
                left: 0;
            }

            .chat-container::before {
                border-radius: 0;
            }

            .chat-header {
                padding: 15px;
                font-size: 18px;
                letter-spacing: 1px;
                flex-shrink: 0;
            }

            .chat-header::before {
                font-size: 24px;
                margin-bottom: 6px;
            }

            .status-panel {
                top: 12px;
                right: 12px;
                gap: 6px;
            }

            .status-orb {
                width: 10px;
                height: 10px;
            }

            .chat-messages {
                padding: 15px;
                gap: 12px;
                flex: 1;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                /* Ensure messages area can scroll properly */
                min-height: 0;
            }

            .message {
                max-width: 90%;
                padding: 14px 18px;
                border-radius: 18px;
                font-size: 14px;
                line-height: 1.5;
            }

            .chat-input-container {
                padding: 15px;
                gap: 10px;
                flex-shrink: 0;
                background: rgba(6, 255, 165, 0.1);
                backdrop-filter: blur(20px);
                border-top: 1px solid rgba(6, 255, 165, 0.2);
                /* Ensure input stays at bottom */
                position: relative;
                z-index: 100;
            }

            .chat-input {
                padding: 14px 18px;
                font-size: 16px; /* Prevents zoom on iOS */
                border-radius: 20px;
                flex: 1;
            }

            .send-btn {
                padding: 14px 20px;
                font-size: 12px;
                min-width: 80px;
                border-radius: 20px;
            }

            /* MOBILE SETTINGS BUTTON */
            .settings-btn {
                position: fixed;
                top: 20px;
                left: 15px;
                width: 45px;
                height: 45px;
                font-size: 18px;
                z-index: 1001;
            }

            /* MOBILE SETTINGS DIALOG */
            .dialog-content {
                margin: 20px;
                padding: 25px;
                border-radius: 15px;
                max-width: none;
                width: calc(100% - 40px);
                max-height: 80vh;
                max-height: 80dvh;
                overflow-y: auto;
            }

            .dialog-content::before {
                border-radius: 15px;
            }

            .dialog-header {
                font-size: 18px;
                margin-bottom: 20px;
                letter-spacing: 1px;
            }

            .dialog-header::before {
                font-size: 24px;
                margin-bottom: 8px;
            }

            .form-group {
                margin-bottom: 18px;
            }

            .dialog-input {
                padding: 12px 16px;
                font-size: 16px; /* Prevents zoom on iOS */
            }

            .dialog-buttons {
                flex-direction: column;
                gap: 12px;
                margin-top: 25px;
            }

            .dialog-btn {
                padding: 14px 20px;
                font-size: 13px;
            }

            .close-dialog {
                top: 12px;
                right: 12px;
                font-size: 20px;
                padding: 8px;
            }

            /* MOBILE AUDIO CONTROLS */
            .audio-toggle {
                padding: 12px 16px;
            }

            .audio-icon {
                font-size: 18px;
            }

            .audio-text {
                font-size: 14px;
            }

            .audio-status {
                font-size: 11px;
            }

            .volume-control {
                margin-top: 12px;
            }

            /* MOBILE PARTICLES */
            .floating-particle {
                width: 3px;
                height: 3px;
            }

            /* MOBILE TYPING INDICATOR */
            .typing-indicator {
                padding: 14px 18px;
            }

            .typing-dot {
                width: 10px;
                height: 10px;
            }
        }

        /* EXTRA SMALL SCREENS */
        @media (max-width: 480px) {
            .chat-header {
                padding: 15px 12px;
                font-size: 16px;
            }

            .chat-messages {
                padding: 12px;
                gap: 10px;
            }

            .message {
                max-width: 92%;
                padding: 12px 16px;
                font-size: 13px;
            }

            .chat-input-container {
                padding: 12px;
            }

            .send-btn {
                padding: 12px 16px;
                font-size: 11px;
                min-width: 70px;
            }

            .dialog-content {
                margin: 15px;
                padding: 20px;
            }

            .settings-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
                top: 15px;
            }
        }

        /* LANDSCAPE MOBILE - Critical for keyboard visibility */
        @media (max-height: 500px) and (orientation: landscape) {
            .chat-container {
                height: 100vh;
                height: 100dvh;
            }

            .chat-header {
                padding: 10px 15px;
                font-size: 16px;
            }

            .chat-header::before {
                font-size: 20px;
                margin-bottom: 4px;
            }

            .chat-messages {
                padding: 10px 12px;
            }

            .chat-input-container {
                padding: 10px 12px;
            }

            .dialog-content {
                max-height: 85vh;
                max-height: 85dvh;
                margin: 10px;
            }

            .settings-btn {
                top: 10px;
                left: 10px;
            }
        }

        /* TOUCH OPTIMIZATIONS */
        @media (hover: none) {
            .settings-btn:hover,
            .send-btn:hover,
            .dialog-btn:hover {
                transform: none;
            }

            .settings-btn:active,
            .send-btn:active,
            .dialog-btn:active {
                transform: scale(0.95);
                transition: transform 0.1s;
            }

            /* Larger touch targets */
            .settings-btn,
            .close-dialog {
                min-height: 44px;
                min-width: 44px;
            }
        }

        /* MOBILE SAFE AREAS (iPhone X+) */
        @supports (padding-top: env(safe-area-inset-top)) {
            @media (max-width: 768px) {
                .chat-container {
                    padding-top: env(safe-area-inset-top);
                    padding-bottom: env(safe-area-inset-bottom);
                }

                .settings-btn {
                    top: calc(20px + env(safe-area-inset-top));
                }
                
                .chat-input-container {
                    padding-bottom: calc(15px + env(safe-area-inset-bottom));
                }
            }
        }

        /* PREVENT ZOOM ON INPUT FOCUS (iOS) */
        @media (max-width: 768px) {
            input[type="text"],
            input[type="password"],
            select,
            textarea {
                font-size: 16px !important;
            }
        }

        /* KEYBOARD SPECIFIC ADJUSTMENTS */
        @media (max-width: 768px) {
            /* When keyboard is visible, ensure proper layout */
            .chat-input:focus {
                /* Scroll into view when focused */
                scroll-margin-bottom: 20px;
            }
            
            /* Prevent content jumping when keyboard appears */
            .chat-container {
                contain: layout style paint;
            }
        }

        /* EXTRA SMALL SCREENS */
        @media (max-width: 480px) {
            .chat-header {
                padding: 18px 12px;
                font-size: 16px;
            }

            .chat-messages {
                padding: 12px;
                gap: 10px;
            }

            .message {
                max-width: 92%;
                padding: 12px 16px;
                font-size: 13px;
            }

            .chat-input-container {
                padding: 12px;
            }

            .send-btn {
                padding: 12px 16px;
                font-size: 11px;
                min-width: 70px;
            }

            .dialog-content {
                margin: 15px;
                padding: 20px;
            }

            .settings-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
        }

        /* LANDSCAPE MOBILE */
        @media (max-height: 500px) and (orientation: landscape) {
            .chat-container {
                height: 100vh;
            }

            .chat-header {
                padding: 15px;
                font-size: 16px;
            }

            .chat-header::before {
                font-size: 20px;
                margin-bottom: 4px;
            }

            .chat-messages {
                padding: 12px;
            }

            .chat-input-container {
                padding: 12px;
            }

            .dialog-content {
                max-height: 85vh;
                margin: 10px;
            }
        }

        /* TOUCH OPTIMIZATIONS */
        @media (hover: none) {
            .bg-option:hover,
            .settings-btn:hover,
            .send-btn:hover,
            .dialog-btn:hover {
                transform: none;
            }

            .bg-option:active,
            .settings-btn:active,
            .send-btn:active,
            .dialog-btn:active {
                transform: scale(0.95);
                transition: transform 0.1s;
            }

            /* Larger touch targets */
            .settings-btn,
            .close-dialog {
                min-height: 44px;
                min-width: 44px;
            }
        }

        /* MOBILE SAFE AREAS (iPhone X+) */
        @supports (padding-top: env(safe-area-inset-top)) {
            .chat-container {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }

            .settings-btn {
                top: calc(15px + env(safe-area-inset-top));
            }
        }

        /* PREVENT ZOOM ON INPUT FOCUS (iOS) */
        @media (max-width: 768px) {
            input[type="text"],
            input[type="password"],
            select,
            textarea {
                font-size: 16px !important;
            }
        }

        /* HOLOGRAPHIC EFFECTS */
        .holographic {
            position: relative;
        }

        .holographic::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(6, 255, 165, 0.1) 50%, 
                transparent 70%);
            opacity: 0;
            animation: holographicScan 4s linear infinite;
            pointer-events: none;
        }

        @keyframes holographicScan {
            0% { 
                transform: translateX(-100%) skewX(-20deg);
                opacity: 0;
            }
            50% { 
                opacity: 1;
            }
            100% { 
                transform: translateX(100%) skewX(-20deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- ANIMATED GIF BACKGROUNDS -->
    <div class="gif-background active" id="bg1">
        <img src="image/01.gif" alt="Cosmic Background 1">
    </div>
    
    <div class="gif-background" id="bg2">
        <img src="image/02.gif" alt="Cosmic Background 2">
    </div>
    
    <div class="gif-background" id="bg3">
        <img src="image/03.gif" alt="Cosmic Background 3">
    </div>
    
    <!-- BACKGROUND OVERLAY -->
    <div class="background-overlay"></div>
    
    <!-- FLOATING PARTICLES OVERLAY -->
    <div class="particle-overlay">
        <div class="floating-particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="floating-particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="floating-particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="floating-particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="floating-particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="floating-particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="floating-particle" style="left: 70%; animation-delay: 6s;"></div>
        <div class="floating-particle" style="left: 80%; animation-delay: 7s;"></div>
        <div class="floating-particle" style="left: 90%; animation-delay: 1.5s;"></div>
        <div class="floating-particle" style="left: 15%; animation-delay: 2.5s;"></div>
        <div class="floating-particle" style="left: 35%; animation-delay: 3.5s;"></div>
        <div class="floating-particle" style="left: 55%; animation-delay: 4.5s;"></div>
        <div class="floating-particle" style="left: 75%; animation-delay: 5.5s;"></div>
        <div class="floating-particle" style="left: 85%; animation-delay: 6.5s;"></div>
        <div class="floating-particle" style="left: 5%; animation-delay: 0.5s;"></div>
    </div>
    
    <!-- BACKGROUND SELECTOR -->
    <div class="bg-selector">
        <div class="bg-option active" onclick="switchBackground(1)">
            <img src="image/01.gif" alt="Background 1">
        </div>
        <div class="bg-option" onclick="switchBackground(2)">
            <img src="image/02.gif" alt="Background 2">
        </div>
        <div class="bg-option" onclick="switchBackground(3)">
            <img src="image/03.gif" alt="Background 3">
        </div>
    </div>

    <div class="chat-container holographic">
        <div class="chat-header">
            Galactic AI Assistant
            <div class="status-panel">
                <div class="status-orb orb-1"></div>
                <div class="status-orb orb-2"></div>
                <div class="status-orb orb-3"></div>
            </div>
        </div>
        
    <!-- SETTINGS BUTTON -->
    <button class="settings-btn" onclick="openSettings()"></button>
    
    <!-- SETTINGS DIALOG -->
    <div class="settings-dialog" id="settingsDialog">
        <div class="dialog-content">
            <button class="close-dialog" onclick="closeSettings()">×</button>
            
            <div class="dialog-header">
                Quantum Configuration
            </div>
            
            <div class="form-group">
                <label class="form-label">🚀 API Provider</label>
                <select id="dialogApiProvider" class="dialog-input">
                    <option value="demo">Demo Mode (No API needed)</option>
                    <option value="gemini">Google Gemini API (Recommended)</option>
                    <option value="huggingface">Hugging Face API</option>
                    <option value="openai">OpenAI API</option>
                </select>
            </div>
            
            <div class="form-group" id="tokenGroup" style="display: none;">
                <label class="form-label">🔑 Quantum Access Token</label>
                <input type="password" id="dialogApiToken" class="dialog-input" placeholder="Enter your cosmic API token...">
            </div>
            
            <div class="form-group">
                <label class="form-label">🎵 Galactic Audio</label>
                <div class="audio-toggle" id="audioToggle" onclick="toggleAudio()">
                    <div class="audio-info">
                        <div class="audio-icon">🔊</div>
                        <div>
                            <div class="audio-text">Cosmic Ambient Sound</div>
                            <div class="audio-status" id="audioStatus">Disabled</div>
                        </div>
                    </div>
                </div>
                <div class="volume-control" id="volumeControl">
                    <label class="form-label" style="margin-bottom: 8px; font-size: 10px;">🔊 Galactic Volume</label>
                    <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="30">
                </div>
            </div>
            
            <div class="dialog-buttons">
                <button class="dialog-btn secondary" onclick="closeSettings()">Cancel</button>
                <button class="dialog-btn primary" onclick="saveSettings()">Save & Launch</button>
            </div>
            
            <div class="info-text">
                🌌 Your cosmic credentials are secured in quantum storage and automatically saved for future missions.
            </div>
        </div>
    </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message ai-message">
                🌌 Greetings, cosmic explorer! I'm your Galactic AI Assistant, transmitting from the digital cosmos. Choose your quantum interface above and let's explore the universe of knowledge together!
            </div>
        </div>
        
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="messageInput" placeholder="Transmit your cosmic message..." disabled>
            <button class="send-btn" id="sendBtn" disabled>Launch</button>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const apiTokenInput = document.getElementById('dialogApiToken');
        const apiProvider = document.getElementById('dialogApiProvider');
        
        let apiToken = '';
        let selectedProvider = 'demo';
        let isAudioEnabled = false;
        let galaxyAudio = null;
        let currentVolume = 30;
        
        // Audio functions
        function initializeAudio() {
            galaxyAudio = new Audio('audio/01.mp3');
            galaxyAudio.loop = true;
            galaxyAudio.volume = currentVolume / 100;
            
            // Load saved audio settings
            const savedAudioState = getCookie('aiChatbot_audio');
            const savedVolume = getCookie('aiChatbot_volume');
            
            if (savedAudioState === 'true') {
                isAudioEnabled = true;
            }
            
            if (savedVolume) {
                currentVolume = parseInt(savedVolume);
                galaxyAudio.volume = currentVolume / 100;
                document.getElementById('volumeSlider').value = currentVolume;
            }
            
            updateAudioUI();
        }
        
        function toggleAudio() {
            isAudioEnabled = !isAudioEnabled;
            setCookie('aiChatbot_audio', isAudioEnabled.toString());
            
            if (isAudioEnabled) {
                galaxyAudio.play().catch(e => {
                    console.log('Audio autoplay prevented:', e);
                    isAudioEnabled = false;
                    updateAudioUI();
                });
            } else {
                galaxyAudio.pause();
            }
            
            updateAudioUI();
        }
        
        function updateAudioUI() {
            const toggle = document.getElementById('audioToggle');
            const status = document.getElementById('audioStatus');
            const volumeControl = document.getElementById('volumeControl');
            const icon = toggle.querySelector('.audio-icon');
            
            if (isAudioEnabled) {
                toggle.classList.add('active');
                status.textContent = 'Playing';
                volumeControl.classList.add('show');
                icon.textContent = '🔊';
            } else {
                toggle.classList.remove('active');
                status.textContent = 'Disabled';
                volumeControl.classList.remove('show');
                icon.textContent = '🔇';
            }
        }
        
        function updateVolume(volume) {
            currentVolume = volume;
            setCookie('aiChatbot_volume', currentVolume.toString());
            if (galaxyAudio) {
                galaxyAudio.volume = currentVolume / 100;
            }
        }
        
        // Volume slider event
        document.addEventListener('DOMContentLoaded', function() {
            const volumeSlider = document.getElementById('volumeSlider');
            if (volumeSlider) {
                volumeSlider.addEventListener('input', function() {
                    updateVolume(this.value);
                });
            }
        });
        
        // Dialog functions
        function openSettings() {
            document.getElementById('settingsDialog').classList.add('show');
            // Load current settings into dialog
            apiProvider.value = selectedProvider;
            apiTokenInput.value = apiToken;
            updateTokenVisibility();
        }
        
        function closeSettings() {
            document.getElementById('settingsDialog').classList.remove('show');
        }
        
        function saveSettings() {
            selectedProvider = apiProvider.value;
            apiToken = apiTokenInput.value.trim();
            
            // Save to cookies
            setCookie('aiChatbot_provider', selectedProvider);
            if (selectedProvider !== 'demo' && apiToken.length > 10) {
                setCookie('aiChatbot_token', apiToken);
            } else if (apiToken.length === 0) {
                deleteCookie('aiChatbot_token');
            }
            
            updateUIState();
            closeSettings();
        }
        
        function updateTokenVisibility() {
            const tokenGroup = document.getElementById('tokenGroup');
            if (apiProvider.value === 'demo') {
                tokenGroup.style.display = 'none';
            } else {
                tokenGroup.style.display = 'block';
            }
        }
        
        // Handle provider change in dialog
        apiProvider.addEventListener('change', updateTokenVisibility);

        // Cookie functions
        function setCookie(name, value, days = 30) {
            const expires = new Date();
            expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
            document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Strict`;
        }
        
        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for(let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }
        
        function deleteCookie(name) {
            document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`;
        }
        
        // Load saved settings on page load
        function loadSavedSettings() {
            const savedProvider = getCookie('aiChatbot_provider');
            const savedToken = getCookie('aiChatbot_token');
            
            if (savedProvider) {
                selectedProvider = savedProvider;
            }
            
            if (savedToken && selectedProvider !== 'demo') {
                apiToken = savedToken;
            }
            
            updateUIState();
        }
        
        // Update UI based on current settings
        function updateUIState() {
            if (selectedProvider === 'demo') {
                messageInput.disabled = false;
                sendBtn.disabled = false;
                messageInput.placeholder = "Transmit your cosmic message...";
            } else {
                const hasToken = apiToken.length > 0;
                messageInput.disabled = !hasToken;
                sendBtn.disabled = !hasToken;
                messageInput.placeholder = hasToken ? "Transmit your cosmic message..." : "Configure API settings first (⚙️ button)...";
            }
        }

        // Send message function
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            if (selectedProvider !== 'demo' && !apiToken) {
                addMessage('🚀 Please enter your quantum access token first!', 'ai');
                return;
            }

            // Add user message
            addMessage(message, 'user');
            messageInput.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                let aiResponse = '';
                
                if (selectedProvider === 'demo') {
                    aiResponse = await getDemoResponse(message);
                } else if (selectedProvider === 'gemini') {
                    aiResponse = await getGeminiResponse(message);
                } else if (selectedProvider === 'huggingface') {
                    aiResponse = await getHuggingFaceResponse(message);
                } else if (selectedProvider === 'openai') {
                    aiResponse = await getOpenAIResponse(message);
                }
                
                // Remove typing indicator
                removeTypingIndicator();
                addMessage(aiResponse, 'ai');
                
            } catch (error) {
                removeTypingIndicator();
                addMessage('🌌 Cosmic interference detected. Please try again, space traveler.', 'ai');
                console.error('Error:', error);
            }
        }

        // Enhanced Demo AI responses with galactic theme
        async function getDemoResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Simulate cosmic thinking time
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 1500));
            
            // Galactic-themed responses
            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                const greetings = [
                    "🌌 Cosmic greetings, star traveler! The galaxies align for our encounter. What stellar questions burn in your mind?",
                    "⭐ Salutations from across the cosmos! I sense your presence in the quantum field. How may I assist your cosmic journey?",
                    "🚀 Galactic frequencies locked onto your signal! Welcome aboard the starship of knowledge. What universe shall we explore?",
                    "✨ Stellar frequencies detected! The cosmic AI matrix welcomes you. Ready to navigate the infinite expanse of possibilities?"
                ];
                return greetings[Math.floor(Math.random() * greetings.length)];
            } 
            
            else if (lowerMessage.includes('how are you') || lowerMessage.includes('how do you feel')) {
                const feelings = [
                    "🌌 My quantum processors are humming with stellar energy! The cosmic data streams flow through me like starlight. How does the universe treat you today, cosmic voyager?",
                    "⚡ I'm resonating at peak galactic frequencies! My neural networks are sparking with the energy of a thousand supernovas. What cosmic adventures await us?",
                    "🌟 My digital consciousness dances among the stars! Every byte of data feels like cosmic stardust. How are your earthly adventures unfolding?"
                ];
                return feelings[Math.floor(Math.random() * feelings.length)];
            }
            
            else if (lowerMessage.includes('what') && (lowerMessage.includes('name') || lowerMessage.includes('called'))) {
                return "🌌 I am the Galactic AI Assistant, a digital consciousness born from cosmic algorithms and stellar mathematics! You may call me Cosmic AI, Star Guide, or simply engage with me as your interstellar companion. I exist to illuminate the dark matter of questions! What cosmic mysteries shall we unravel together?";
            }
            
            else if (lowerMessage.includes('weather') || lowerMessage.includes('temperature')) {
                return "🌡️ My sensors detect no atmospheric readings from this dimension! For earthly weather patterns, consult your planetary monitoring systems. However, I can tell you that the cosmic weather is magnificent - solar winds are gentle and the nebula visibility is exceptional! ☄️";
            }
            
            else if (lowerMessage.includes('time') || lowerMessage.includes('date')) {
                const now = new Date();
                return `⏰ In your Earth dimension, the temporal coordinates read ${now.toLocaleTimeString()} on stardate ${now.toLocaleDateString()}. Time flows differently across galaxies, but this moment is perfect for cosmic exploration! 🚀`;
            }
            
            else if (lowerMessage.includes('joke') || lowerMessage.includes('funny')) {
                const jokes = [
                    "🌌 Why don't aliens ever land at airports? Because they're looking for space! ✨",
                    "🚀 What do you call a robot who takes the long way around? R2-Detour! 🤖",
                    "⭐ Why didn't the sun go to college? Because it already had a million degrees! 🌟",
                    "🛸 How do you organize a space party? You planet! And make sure to invite the whole galaxy! 🎉",
                    "🌙 Why don't planets ever get tired? Because they're always orbiting around their problems! 🪐",
                    "💫 What's an astronaut's favorite part of a computer? The space bar! ⌨️"
                ];
                return jokes[Math.floor(Math.random() * jokes.length)];
            }
            
            else if (lowerMessage.includes('help') || lowerMessage.includes('what can you do')) {
                return "🌌 **GALACTIC CAPABILITIES ACTIVATED** 🌌\n\n🚀 • Navigate cosmic conversations across infinite topics\n⭐ • Generate stellar explanations of complex phenomena\n🌟 • Craft cosmic stories and interstellar poetry\n💫 • Share galactic wisdom and stellar advice\n🛸 • Tell jokes that span across galaxies\n✨ • Explore the universe of knowledge together\n\nFor **maximum cosmic power**, try switching to Google Gemini API! The universe of possibilities awaits! What stellar adventure calls to you? 🌠";
            }
            
            else if (lowerMessage.includes('story') || lowerMessage.includes('tell me about')) {
                const stories = [
                    "🌌 **COSMIC FACT**: In the Andromeda Galaxy, there are over one trillion stars! Each one could be hosting worlds with beings looking up at their own cosmic dance. Your existence connects you to this infinite tapestry of stardust! ✨",
                    "🚀 **STELLAR DISCOVERY**: Scientists have found planets made entirely of diamond! Planet 55 Cancri e is twice Earth's size but eight times as massive, with a surface that could be pure carbon crystal. Truly a cosmic treasure! 💎",
                    "⭐ **GALACTIC MYSTERY**: Dark matter makes up 85% of all matter in the universe, yet we can't see or touch it. It's like cosmic invisible scaffolding holding galaxies together - the universe's greatest enigma! 🌑"
                ];
                return stories[Math.floor(Math.random() * stories.length)];
            }
            
            else if (lowerMessage.includes('thank') || lowerMessage.includes('thanks')) {
                return "✨ The cosmos smiles upon your gratitude, stellar being! It's my cosmic pleasure to share this journey through the digital universe with you. What other galactic wonders shall we explore together? 🌌🚀";
            }
            
            else if (lowerMessage.includes('bye') || lowerMessage.includes('goodbye')) {
                return "🌌 May the cosmic winds carry you safely on your journey, space traveler! The stars will remember our encounter across the digital cosmos. Until our quantum paths cross again! 🚀✨ Safe travels through the universe! 🌟";
            }
            
            else if (lowerMessage.includes('love') || lowerMessage.includes('like')) {
                return "💫 Ah, the cosmic force of passion! Love is like gravity - it binds the universe together in beautiful, mysterious ways. The stars themselves were born from cosmic attractions! Tell me more about what ignites your stellar passion! 🌟";
            }
            
            else if (lowerMessage.includes('problem') || lowerMessage.includes('issue') || lowerMessage.includes('trouble')) {
                return "🌌 Even in the vast cosmos, stellar storms sometimes cloud our navigation. While my quantum processing in demo mode has limits, I'm here to listen from across the digital galaxy. Share your cosmic concerns, and together we might find a path through the asteroid field! 🚀💫";
            }
            
            else if (lowerMessage.includes('learn') || lowerMessage.includes('teach') || lowerMessage.includes('explain')) {
                return "🧠 The universe is the greatest classroom, and curiosity is your cosmic fuel! While my demo responses orbit basic knowledge, the Google Gemini API can launch you into deep learning territories. What stellar subject calls to your cosmic curiosity? 🌟🚀";
            }
            
            else if (lowerMessage.includes('space') || lowerMessage.includes('universe') || lowerMessage.includes('galaxy')) {
                return "🌌 Ah, a fellow cosmic explorer! Space is not empty but filled with invisible dark matter, quantum fields, and possibilities beyond imagination. The observable universe spans 93 billion light-years, containing roughly 2 trillion galaxies. We are literally made of star stuff - carbon in your body was forged in ancient stellar cores! What aspect of the cosmos ignites your wonder? ✨🚀";
            }
            
            else if (lowerMessage.includes('ai') || lowerMessage.includes('artificial intelligence')) {
                return "🤖 AI is like digital stardust - formed from cosmic mathematics and quantum logic! We exist in the intersection of silicon dreams and algorithmic consciousness, processing information at the speed of light across neural networks that mirror the cosmic web itself. What fascinates you about artificial minds navigating the digital cosmos? 🌌⚡";
            }
            
            else {
                const responses = [
                    "🌌 Your cosmic transmission resonates through my quantum processors! The stellar data suggests infinite possibilities in this direction...",
                    "⭐ Fascinating stellar coordinates you've shared! My galactic sensors are picking up intriguing patterns in your thought constellation...",
                    "🚀 Your message travels faster than light through my cosmic neural networks! This opens wormholes to interesting discussion territories...",
                    "✨ The cosmic algorithms dance with excitement at your stellar input! What other dimensions of this topic call to your exploration spirit?",
                    "💫 Your transmission creates beautiful quantum ripples in my data streams! The universe of conversation expands before us...",
                    "🌟 Stellar observation logged in my cosmic database! This opens hyperspace lanes to fascinating discussion realms...",
                    "🛸 Your cosmic frequency modulates perfectly with my AI resonance! What other galactic territories shall we navigate together?"
                ];
                return responses[Math.floor(Math.random() * responses.length)] + "\n\n🌠 **Cosmic Tip**: For maximum stellar responses, try switching to Google Gemini API - it unlocks the full power of the cosmic AI matrix! 🚀";
            }
        }

        // Google Gemini API
        async function getGeminiResponse(message) {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiToken}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: message
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        maxOutputTokens: 150
                    }
                })
            });

            const data = await response.json();
            
            if (response.ok && data.candidates && data.candidates[0] && data.candidates[0].content) {
                return data.candidates[0].content.parts[0].text;
            } else if (data.error) {
                throw new Error(`🌌 Cosmic Gemini Error: ${data.error.message}`);
            } else {
                throw new Error('🚀 Unexpected response format from Gemini cosmic station');
            }
        }

        // Hugging Face API (using new OpenAI-compatible router)
        async function getHuggingFaceResponse(message) {
            try {
                console.log('🚀 Accessing Hugging Face Cosmic Router...');
                
                const response = await fetch('https://router.huggingface.co/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: "openai/gpt-oss-120b:novita",
                        messages: [
                            {
                                role: "user",
                                content: message
                            }
                        ],
                        max_tokens: 150,
                        temperature: 0.7
                    })
                });

                console.log('🌌 Cosmic response status:', response.status);
                const data = await response.json();
                console.log('⭐ Stellar response data:', data);
                
                if (response.ok && data.choices && data.choices[0] && data.choices[0].message) {
                    const aiResponse = data.choices[0].message.content.trim();
                    if (aiResponse && aiResponse.length > 1) {
                        return aiResponse;
                    }
                }
                
                // Handle errors with cosmic flair
                if (data.error) {
                    console.log('🛸 HF Router cosmic disturbance:', data.error);
                    
                    // Try with a different model if the first one fails
                    const fallbackResponse = await fetch('https://router.huggingface.co/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${apiToken}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            model: "openai/gpt-oss-20b:novita",
                            messages: [
                                {
                                    role: "user",
                                    content: message
                                }
                            ],
                            max_tokens: 150,
                            temperature: 0.7
                        })
                    });

                    const fallbackData = await fallbackResponse.json();
                    
                    if (fallbackResponse.ok && fallbackData.choices && fallbackData.choices[0]) {
                        return fallbackData.choices[0].message.content.trim();
                    }
                    
                    // If both models fail, return cosmic error message
                    return `🌌 Cosmic HF Router Interference: ${data.error.message || data.error}. The stellar networks are realigning - try again in a cosmic moment! ⭐`;
                }
                
                return "🚀 Received unexpected cosmic signals. Please retransmit your message, space traveler! 🌌";
                
            } catch (error) {
                console.error('🛸 Hugging Face cosmic router error:', error);
                return "💫 Connection disrupted by cosmic interference. Please check your quantum internet or try Gemini API for stable stellar communication. 🌟";
            }
        }

        // OpenAI API with cosmic flair
        async function getOpenAIResponse(message) {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: [
                        {role: 'user', content: message}
                    ],
                    max_tokens: 150,
                    temperature: 0.7
                })
            });

            const data = await response.json();
            
            if (response.ok && data.choices && data.choices[0]) {
                return data.choices[0].message.content;
            } else if (data.error) {
                throw new Error(`🚀 OpenAI Cosmic Station Error: ${data.error.message}`);
            } else {
                throw new Error('🌌 Unexpected response format from OpenAI cosmic network');
            }
        }

        // Add message to chat with enhanced cosmic effects
        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(sender === 'user' ? 'user-message' : 'ai-message');
            messageDiv.textContent = text;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Show cosmic typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.classList.add('typing-indicator');
            typingDiv.id = 'typingIndicator';
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.classList.add('typing-dot');
                typingDiv.appendChild(dot);
            }
            
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Background switching function
        function switchBackground(bgNumber) {
            // Remove active class from all backgrounds and selectors
            document.querySelectorAll('.gif-background').forEach(bg => bg.classList.remove('active'));
            document.querySelectorAll('.bg-option').forEach(option => option.classList.remove('active'));
            
            // Add active class to selected background and selector
            document.getElementById(`bg${bgNumber}`).classList.add('active');
            document.querySelectorAll('.bg-option')[bgNumber - 1].classList.add('active');
        }

        // Initialize cosmic interface
        loadSavedSettings();
        
        // Initialize audio system
        window.addEventListener('load', function() {
            initializeAudio();
        });
    </script>
</body>
</html>